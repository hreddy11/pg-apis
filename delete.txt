urlpatterns = [
    path('', views.index, name='index'),
    path('user_selections/', views.user_selections, name='user_selections'),
]

import json
from django.http import JsonResponse

def user_selections(request):
    if request.method == 'POST':
        selected_files = json.loads(request.body)
        return JsonResponse({'selected_files': selected_files})
    else:
        return JsonResponse({'error': 'Invalid request method'})

<!DOCTYPE html>
<html>
<head>
    <title>Google Cloud Storage Bucket Items</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-1.12.1.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Google Cloud Storage Bucket Items</h1>
        <form method="post" id="selection-form">
            {% csrf_token %}
            {% for blob in blobs %}
                <div class="checkbox">
                    <label>
                        <input type="checkbox" name="selected_files" value="{{ blob.name }}">
                        {{ blob.name }}
                    </label>
                </div>
            {% endfor %}
            <button type="button" id="submit-button" class="btn btn-primary" disabled>Download Selected Files</button>
        </form>
    </div>

    <script>
        $(function () {
            var $submitBtn = $('#submit-button');

            $('input[name="selected_files"]').change(function () {
                var anyChecked = $('input[name="selected_files"]:checked').length > 0;
                $submitBtn.prop('disabled', !anyChecked);
            });

            $submitBtn.click(function () {
                var selectedFiles = $('input[name="selected_files"]:checked').map(function () {
                    return $(this).val();
                }).get();

                if (selectedFiles.length > 0) {
                    $.ajax({
                        type: 'POST',
                        url: '/user_selections/',
                        headers: {
                            'X-CSRFToken': '{{ csrf_token }}'
                        },
                        data: JSON.stringify(selectedFiles),
                        contentType: 'application/json',
                        success: function (data) {
                            console.log('Response from server:', data);
                        },
                        error: function (error) {
                            console.error('Error:', error);
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>

{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>User Information</h2>
    <table class="table table-bordered">
        <tbody>
            <tr>
                <th>ID</th>
                <td>{{ user_info.id }}</td>
            </tr>
            <tr>
                <th>Name</th>
                <td>{{ user_info.name }}</td>
            </tr>
            <tr>
                <th>Info</th>
                <td>
                    <div class="input-group">
                        <input id="info-input" type="text" class="form-control" value="{{ user_info.info }}" readonly>
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" onclick="copyToClipboard()">
                                Copy
                            </button>
                        </span>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<script>
    function copyToClipboard() {
        var copyText = document.getElementById("info-input");
        copyText.select();
        document.execCommand("copy");
        alert("Info copied to clipboard!");
    }
</script>
{% endblock %}


<style>
    .autosize {
        resize: none;
        overflow: hidden;
        height: auto;
    }
    .autosize:focus {
        outline: none;
    }
</style>


